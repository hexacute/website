<!DOCTYPE html><html ><head><title data-react-helmet="true">ES6, ES2015 : le protocole d&#x27;itération | Putain de code</title><meta data-react-helmet="true" charset="UTF-8"/><meta data-react-helmet="true" name="description" value="Blog participatif de la communauté dev"/><meta data-react-helmet="true" content="width=device-width, initial-scale=1, shrink-to-fit=no, viewport-fit=cover" name="viewport"/><meta data-react-helmet="true" content="summary_large_image" name="twitter:card"/><meta data-react-helmet="true" content="Putain de code !" property="og:site_name"/><meta data-react-helmet="true" content="@putaindecode" name="twitter:site"/><meta data-react-helmet="true" content="https://putaindecode.io/public/images/website/share.jpg" property="og:image"/><meta data-react-helmet="true" content="https://putaindecode.io/public/images/website/share.jpg" name="twitter:image"/><meta data-react-helmet="true" content="1500" property="og:image:width"/><meta data-react-helmet="true" content="777" property="og:image:height"/><meta data-react-helmet="true" content="ES6, ES2015 : le protocole d&#x27;itération | Putain de code" property="og:title"/><meta data-react-helmet="true" content="ES6, ES2015 : le protocole d&#x27;itération | Putain de code" name="twitter:title"/><link data-react-helmet="true" title="RSS Feed" href="/api/articles/feeds/desc/feed.xml" rel="alternate" type="application/rss+xml"/><link data-react-helmet="true" href="/favicon.ico" rel="shortcut icon"/><link data-react-helmet="true" href="https://putaindecode.io/articles/es6-es2015-le-protocole-d-iteration" rel="canonical"/><script>window.PAGES_BOOT_MODE="hydrate";</script></head><div id="root"><style data-emotion-rpcss="cv6q29 cqg32g vfl2jy 94ols9 1plrth7 1qdfdal">@-webkit-keyframes animation-cv6q29{0%{opacity:0;-webkit-transform:translateY(20px);-ms-transform:translateY(20px);transform:translateY(20px);}}@keyframes animation-cv6q29{0%{opacity:0;-webkit-transform:translateY(20px);-ms-transform:translateY(20px);transform:translateY(20px);}}body{padding:0;margin:0;background-color:#fff;font-family:-apple-system,BlinkMacSystemFont,"Segoe UI","Roboto","Oxygen","Ubuntu","Cantarell","Fira Sans","Droid Sans","Helvetica Neue",sans-serif;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;min-height:100vh;overflow-x:hidden;}@media (prefers-color-scheme:dark){body{background-color:#222;}}#root{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;-webkit-align-items:stretch;-webkit-box-align:stretch;-ms-flex-align:stretch;align-items:stretch;-webkit-box-flex:1;-webkit-flex-grow:1;-ms-flex-positive:1;flex-grow:1;}html{color:#46515B;font-size:1em;line-height:1.4;-webkit-font-smoothing:antialiased;-webkit-text-size-adjust:100%;}@media (prefers-color-scheme:dark){html{color:#ddd;}}a{color:#CC0613;-webkit-text-decoration:underline;text-decoration:underline;}@media (prefers-color-scheme:dark){a{color:#F87098;}}a:hover{-webkit-text-decoration:none;text-decoration:none;}*,*:before,*:after{box-sizing:border-box;}</style><style data-emotion-rpcss="u6xx5u">.rpcss-u6xx5u{background-color:#000;padding:10px;color:#fff;text-align:center;}</style><div class="rpcss-u6xx5u"><style data-emotion-rpcss="fyih5c">.rpcss-fyih5c{font-size:24px;font-weight:700;}</style><div class="rpcss-fyih5c" role="heading">Black Lives Matter</div><div><style data-emotion-rpcss="th8dfi">.rpcss-th8dfi{font-size:20px;color:#8CBEF9;}</style><a class="rpcss-th8dfi" href="https://blacklivesmatters.carrd.co/#">Comment aider</a> • <a class="rpcss-th8dfi" href="https://minnesotafreedomfund.org">Minnesota Freedom Fund</a> • <a class="rpcss-th8dfi" href="https://www.okpal.com/adama-traore/#/">Justice Pour Adama</a></div></div><style data-emotion-rpcss="1s4nnc7">.rpcss-1s4nnc7{background-color:#CC0613;background-image:linear-gradient(135deg,#E51D58 0%,#CC0613 100%);}</style><header class="rpcss-1s4nnc7" style="background-image:linear-gradient(to bottom right, hsl(64, 100%, 35%), hsl(54, 100%, 30%))"><style data-emotion-rpcss="1qqk0tr">.rpcss-1qqk0tr{padding-left:env(safe-area-inset-left);padding-right:env(safe-area-inset-right);}</style><div class="rpcss-1qqk0tr"><style data-emotion-rpcss="qx7dny">.rpcss-qx7dny{width:100%;max-width:1024px;margin:0 auto;padding:0 10px;-webkit-box-flex:1;-webkit-flex-grow:1;-ms-flex-positive:1;flex-grow:1;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;-webkit-align-items:stretch;-webkit-box-align:stretch;-ms-flex-align:stretch;align-items:stretch;}</style><div class="rpcss-qx7dny"><style data-emotion-rpcss="7s9om2">.rpcss-7s9om2{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;padding:20px 0 50px;}</style><div class="rpcss-7s9om2"><style data-emotion-rpcss="gdpa5c">.rpcss-gdpa5c{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-text-decoration:none;text-decoration:none;}</style><a class="rpcss-gdpa5c" href="/"><style data-emotion-rpcss="1lm4738">.rpcss-1lm4738{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:row;-ms-flex-direction:row;flex-direction:row;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-text-decoration:none;text-decoration:none;padding-bottom:10px;}</style><div class="rpcss-1lm4738"><style data-emotion-rpcss="13o7eu2">.rpcss-13o7eu2{display:block;}</style><svg class="rpcss-13o7eu2" height="36px" width="36px" viewBox="0 0 36 36"><defs><linearGradient id="PutainDeCodeLogoGradient" x1="50%" x2="50%" y1="0%" y2="127.223881%"><stop offset="0%" stop-color="#E41D57"></stop><stop offset="100%" stop-color="#C60000"></stop></linearGradient></defs><circle cx="18" cy="18" fill="url(#PutainDeCodeLogoGradient)" r="17" stroke="#FFFFFF" stroke-width="2"></circle><polygon fill="#FFFFFF" points="15.9033203 18.2246094 15.9033203 18.3710938 11.2304688 20.5317383 11.2304688 22.8095703 18.0566406 19.184082 18.0566406 17.4116211 11.2304688 13.7788086 11.2304688 16.0639648"></polygon><rect height="14" width="2" fill="#FFFFFF" x="22" y="11"><animate attributeName="opacity" begin="100ms" calcMode="discrete" dur="2s" repeatCount="indefinite" values="1;0"></animate></rect></svg><style data-emotion-rpcss="4cf197">.rpcss-4cf197{width:10px;height:10px;-webkit-flex-shrink:0;-ms-flex-negative:0;flex-shrink:0;}</style><div class="rpcss-4cf197"></div><style data-emotion-rpcss="u5k24">.rpcss-u5k24{font-size:22px;color:#fff;font-weight:800;}</style><div aria-level="2" class="rpcss-u5k24" role="heading">Putain de code !</div></div><style data-emotion-rpcss="1nyebg4">.rpcss-1nyebg4{font-size:14px;color:rgba(255,255,255,0.8);text-align:center;}</style><div class="rpcss-1nyebg4">Blog participatif de la communauté dev</div></a></div></div></div></header><style data-emotion-rpcss="kcj2v3">.rpcss-kcj2v3{background-color:#F9F6F6;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;-webkit-box-flex:1;-webkit-flex-grow:1;-ms-flex-positive:1;flex-grow:1;}@media (prefers-color-scheme:dark){.rpcss-kcj2v3{background-color:#111;}}</style><div class="rpcss-kcj2v3"><style data-emotion-rpcss="ees1g6">.rpcss-ees1g6{-webkit-animation:animation-cv6q29 500ms ease-out 0ms 1 normal none running;animation:animation-cv6q29 500ms ease-out 0ms 1 normal none running;}</style><div class="rpcss-ees1g6"><div class="rpcss-1qqk0tr"><div class="rpcss-qx7dny"><style data-emotion-rpcss="1qc2bam">.rpcss-1qc2bam{font-size:42px;font-weight:800;text-align:center;padding-top:40px;line-height:1.2;margin:0;}</style><h1 class="rpcss-1qc2bam">ES6, ES2015 : le protocole d&#x27;itération</h1><style data-emotion-rpcss="4ach9y">.rpcss-4ach9y{font-size:16px;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:row;-ms-flex-direction:row;flex-direction:row;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;padding-top:10px;padding-bottom:40px;color:#46515B;-webkit-text-decoration:none;text-decoration:none;}@media (prefers-color-scheme:dark){.rpcss-4ach9y{color:#ccc;}}</style><a class="rpcss-4ach9y" href="https://github.com/ffesseler"><style data-emotion-rpcss="uco8i7">.rpcss-uco8i7{width:32px;height:32px;border-radius:100%;margin-right:10px;}</style><img class="rpcss-uco8i7" alt="ffesseler" src="https://avatars.githubusercontent.com/ffesseler?size=64"/><div>ffesseler<!-- --> <!-- -->•<!-- --> <time dateTime="Wed, 09 Dec 2015 00:00:00 GMT">2015/12/09</time></div></a><style data-emotion-rpcss="1ow2283">.rpcss-1ow2283{max-width:640px;width:100%;font-size:18px;margin:0 auto;line-height:1.7;}.rpcss-1ow2283 h2,.rpcss-1ow2283 h3,.rpcss-1ow2283 h4,.rpcss-1ow2283 h5,.rpcss-1ow2283 h6{font-family:-apple-system,BlinkMacSystemFont,"Segoe UI","Roboto","Oxygen","Ubuntu","Cantarell","Fira Sans","Droid Sans","Helvetica Neue",sans-serif;font-weight:800;line-height:1.2;}.rpcss-1ow2283 img{max-width:100%;background-color:rgba(255,255,255,0.75);}.rpcss-1ow2283 code{font-size:0.9em;font-family:PragmataPro,SFMono-Regular,Consolas,Liberation Mono,Menlo,Courier,monospace;line-height:1;background-color:#FAF3E1;margin:0 0.2em;}@media (prefers-color-scheme:dark){.rpcss-1ow2283 code{background-color:#4F3804;}}.rpcss-1ow2283 pre{padding:10px;overflow-x:auto;font-size:14px;border-radius:10px;border:2px solid rgba(0,0,0,0.1);-webkit-overflow-scrolling:touch;}@media (prefers-color-scheme:dark){.rpcss-1ow2283 pre{border:2px solid rgba(255,255,255,0.1);}}.rpcss-1ow2283 pre code{font-size:14px;background-color:transparent;margin:0;}.rpcss-1ow2283 blockquote{padding-left:20px;margin:0;font-size:16px;border-left:3px solid rgba(0,0,0,0.4);font-style:italic;}.rpcss-1ow2283 .hljs-keyword{color:#DA6BB5;}.rpcss-1ow2283 .hljs-constructor{color:#DD792B;}.rpcss-1ow2283 .hljs-identifier{color:#1E9EA7;}.rpcss-1ow2283 .hljs-module-identifier{color:#C84682;}.rpcss-1ow2283 .hljs-string{color:#3BA1C8;}.rpcss-1ow2283 .hljs-comment{color:#aaa;}.rpcss-1ow2283 .hljs-operator{color:#DA6BB5;}.rpcss-1ow2283 .hljs-attribute{color:#4CB877;}.rpcss-1ow2283 table{width:100%;text-align:center;}.rpcss-1ow2283 figure{padding:20px 0;}.rpcss-1ow2283 figcaption{text-align:center;}.rpcss-1ow2283 a{overflow-wrap:break-word;}.rpcss-1ow2283 table thead th{background-color:#E4EBEE;padding:10px 0;}</style><div class="rpcss-1ow2283"><p>Imaginez un concept si important que si vous l’enleviez du langage, il faudrait
en conséquence enlever le spread, le destructuring, les générateurs, le for…of
et bien d’autres. Ce concept, introduit dans l’ES6, est en fait un protocole :
le protocole d’itération.</p>
<p>Le principe est de définir une convention dans le langage, qui permet de
standardiser la façon dont des sources de données peuvent être traversées.</p>
<p>Première bonne nouvelle, ce protocole est assez simple à comprendre et se base
sur 2 &quot;interfaces&quot; (oui les guillemets c’est pour dire qu’on ne parle pas
d’interface au sens technique, puisqu’elles n’existent pas en JS).</p>
<p>La première interface, appelée <strong>Iterator</strong> permet à un objet de produire des
valeurs en séquence. Un objet est un Iterator lorsqu’il implémente une function
<code>next()</code> qui retourne un objet avec 2 propriétés :</p>
<ul>
<li><code>value</code>: la valeur courante lors de l'itération</li>
<li><code>done</code> : un booléen qui indique si on a atteint la fin de l’itération ou non</li>
</ul>
<p>Les appels successifs à la méthode <code>next()</code> d’un Iterator permettent donc de
traverser et récupérer les valeurs d’un objet. Prenons l’exemple de l’Iterator
retourné par un Array qui contiendrait 2 valeurs (&quot;a&quot; et &quot;b&quot;) :</p>
<pre><code class="language-js">iteratorArray.next();
<span class="hljs-comment">// -&gt; Object {value: &quot;a&quot;, done: false}</span>
iteratorArray.next();
<span class="hljs-comment">// -&gt; Object {value: &quot;b&quot;, done: false}</span>
iteratorArray.next();
<span class="hljs-comment">// -&gt; Object {value: undefined, done: true}</span>
</code></pre>
<p>Mais comment récupérer l’Iterator d’un objet vas-tu me dire ? (n’est-ce pas ?)
Ça tombe bien, c’est le rôle de la seconde interface, appelée <strong>Iterable</strong>. Un
objet est Iterable s’il implémente une méthode particulière qui va retourner
l'Iterator. Cette méthode particulière (appelée <em>@@iterator</em> dans la
spécification) doit être définie en utilisant le symbole <code>[Symbol.iterator]</code>.
(Les symboles seront expliqués dans un prochain article, pas de panique).</p>
<p>En reprenant l’exemple précédent, voici comment récupérer l’Iterator d’un Array
:</p>
<pre><code class="language-js"><span class="hljs-keyword">const</span> arr = [<span class="hljs-string">&quot;a&quot;</span>, <span class="hljs-string">&quot;b&quot;</span>];
<span class="hljs-keyword">const</span> iteratorArray = arr[<span class="hljs-built_in">Symbol</span>.iterator]();
iteratorArray.next();
<span class="hljs-comment">// -&gt; Object {value: &quot;a&quot;, done: false}</span>
iteratorArray.next();
<span class="hljs-comment">// -&gt; Object {value: &quot;b&quot;, done: false}</span>
iteratorArray.next();
<span class="hljs-comment">// -&gt; Object {value: undefined, done: true}</span>
</code></pre>
<p>L’exemple ci-dessus illustre donc l’implémentation du protocole par l’Array. Il
n’est pas très utile en soi, en voici donc un autre qui va permettre de boucler
sur les valeurs et les afficher :</p>
<pre><code class="language-js"><span class="hljs-keyword">const</span> arr = [<span class="hljs-string">&quot;a&quot;</span>, <span class="hljs-string">&quot;b&quot;</span>];
<span class="hljs-keyword">var</span> iterator = arr[<span class="hljs-built_in">Symbol</span>.iterator]();

<span class="hljs-keyword">var</span> result = iterator.next();
<span class="hljs-keyword">while</span> (!result.done) {
  <span class="hljs-built_in">console</span>.log(result.value);
  result = iterator.next();
}
<span class="hljs-comment">// &#x27;a&#x27;</span>
<span class="hljs-comment">// &#x27;b&#x27;</span>
</code></pre>
<p>De manière générale, quand un objet qui implémente le protocole d’itération est
traversé, sa méthode <em>@@iterator</em> est appelée (une seule fois donc) et
l’Iterator retourné est utilisé pour boucler sur ses valeurs.</p>
<h1>Consommateurs d'Iterable</h1>
<p>La deuxième bonne nouvelle, c’est que plusieurs concepts du langage tirent
avantage de ce protocole :</p>
<ul>
<li>Certaines syntaxes s’attendent à recevoir des Iterables</li>
</ul>
<pre><code class="language-js"><span class="hljs-keyword">const</span> arr = [<span class="hljs-string">&quot;a&quot;</span>, <span class="hljs-string">&quot;b&quot;</span>];

<span class="hljs-comment">// La syntaxe à laquelle on pense immédiatement est la syntaxe « for .. of »</span>
<span class="hljs-comment">// qui permet de boucler sur les valeurs des Iterables.</span>
<span class="hljs-keyword">for</span> (val <span class="hljs-keyword">of</span> arr) {
  <span class="hljs-built_in">console</span>.log(val);
}

<span class="hljs-comment">// Le spread qui permet d&#x27;insérer facilement des valeurs dans un Array</span>
<span class="hljs-comment">// utilise également des Iterable</span>
[<span class="hljs-string">&quot;0&quot;</span>, ...arr, <span class="hljs-string">&quot;1&quot;</span>]; <span class="hljs-comment">// 0, a, b, 1</span>

<span class="hljs-comment">// yield nécessite également des Iterable</span>
<span class="hljs-function"><span class="hljs-keyword">function</span>* <span class="hljs-title">gen</span>(<span class="hljs-params"></span>) </span>{
  <span class="hljs-keyword">yield</span>* arr;
}
gen().next(); <span class="hljs-comment">// { value:&quot;a&quot;, done:false }</span>

<span class="hljs-comment">// Le destructuring avec le pattern Array</span>
<span class="hljs-keyword">const</span> [x, y] = arr; <span class="hljs-comment">// x = &#x27;a&#x27;,  y = &quot;b&quot;</span>
</code></pre>
<ul>
<li>Des API acceptent également des Iterables</li>
</ul>
<pre><code class="language-js"><span class="hljs-keyword">const</span> arr = [<span class="hljs-string">&quot;a&quot;</span>, <span class="hljs-string">&quot;b&quot;</span>, <span class="hljs-string">&quot;b&quot;</span>];

<span class="hljs-comment">// Certains constructeurs acceptent des Iterable</span>

<span class="hljs-comment">// Set et Weakset</span>
<span class="hljs-keyword">const</span> set = <span class="hljs-keyword">new</span> <span class="hljs-built_in">Set</span>(arr);
set.has(<span class="hljs-string">&quot;b&quot;</span>); <span class="hljs-comment">// true</span>
<span class="hljs-comment">// Map et WeakMap</span>
<span class="hljs-keyword">const</span> map = <span class="hljs-keyword">new</span> <span class="hljs-built_in">Map</span>(arr.entries()); <span class="hljs-comment">// Attention, le constructeur attend un ensemble [clé, valeur]</span>
map.get(<span class="hljs-number">0</span>); <span class="hljs-comment">// &#x27;a&#x27;</span>

<span class="hljs-comment">// Ou encore les API suivants :</span>

<span class="hljs-built_in">Array</span>.from(iterable); <span class="hljs-comment">// transforme n&#x27;importe quel Iterable en Array.</span>
<span class="hljs-built_in">Promise</span>.all(iterableCollectionDePromises); <span class="hljs-comment">// n&#x27;importe quel Iterable qui contient un ensemble de Promises</span>
<span class="hljs-built_in">Promise</span>.race(iterableCollectionDePromises); <span class="hljs-comment">// idem</span>
</code></pre>
<h1>Built-in Iterable</h1>
<p>Troisième bonne nouvelle, plusieurs objets du langage implémentent déjà ce
protocole :</p>
<pre><code class="language-js"><span class="hljs-comment">// évidemment les Array</span>
<span class="hljs-keyword">const</span> arr = [<span class="hljs-string">&quot;l&quot;</span>, <span class="hljs-string">&quot;o&quot;</span>, <span class="hljs-string">&quot;l&quot;</span>];
<span class="hljs-keyword">for</span> (v <span class="hljs-keyword">of</span> arr) {
  <span class="hljs-built_in">console</span>.log(v);
  <span class="hljs-comment">// &#x27;l&#x27;</span>
  <span class="hljs-comment">// &#x27;o&#x27;</span>
  <span class="hljs-comment">// &#x27;l&#x27;</span>
}

<span class="hljs-comment">// les String</span>
<span class="hljs-keyword">const</span> str = <span class="hljs-string">&quot;lol&quot;</span>;
<span class="hljs-keyword">for</span> (v <span class="hljs-keyword">of</span> str) {
  <span class="hljs-built_in">console</span>.log(v);
  <span class="hljs-comment">// &#x27;l&#x27;</span>
  <span class="hljs-comment">// &#x27;o&#x27;</span>
  <span class="hljs-comment">// &#x27;l&#x27;</span>
}

<span class="hljs-comment">// les Map et Set (mais PAS WeakMap et WeakSet)</span>
<span class="hljs-keyword">const</span> map = <span class="hljs-keyword">new</span> <span class="hljs-built_in">Map</span>().set(<span class="hljs-string">&quot;l&quot;</span>, <span class="hljs-number">1</span>).set(<span class="hljs-string">&quot;o&quot;</span>, <span class="hljs-number">2</span>);
<span class="hljs-keyword">for</span> (v <span class="hljs-keyword">of</span> map) {
  <span class="hljs-built_in">console</span>.log(v);
  <span class="hljs-comment">// [&quot;l&quot;, 1]</span>
  <span class="hljs-comment">// [&quot;o&quot;, 2]</span>
}
<span class="hljs-keyword">const</span> set = <span class="hljs-keyword">new</span> <span class="hljs-built_in">Set</span>().add(<span class="hljs-string">&quot;l&quot;</span>).add(<span class="hljs-string">&quot;o&quot;</span>);
<span class="hljs-keyword">for</span> (v <span class="hljs-keyword">of</span> map) {
  <span class="hljs-built_in">console</span>.log(v);
  <span class="hljs-comment">// &#x27;l&#x27;</span>
  <span class="hljs-comment">// &#x27;o&#x27;</span>
}

<span class="hljs-comment">// Les TypedArray que vous utilisez tous les jours</span>
<span class="hljs-keyword">const</span> int16 = <span class="hljs-keyword">new</span> <span class="hljs-built_in">Int16Array</span>(<span class="hljs-number">2</span>);
int16[<span class="hljs-number">0</span>] = <span class="hljs-number">42</span>;
<span class="hljs-keyword">for</span> (v <span class="hljs-keyword">of</span> int16) {
  <span class="hljs-built_in">console</span>.log(v);
  <span class="hljs-comment">// 42</span>
  <span class="hljs-comment">// 0</span>
}

<span class="hljs-comment">// Même l&#x27;objet spécial arguments (que vous</span>
<span class="hljs-comment">// ne devriez plus utiliser avec l&#x27;ES6) est un Iterable</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">test</span>(<span class="hljs-params"></span>) </span>{
  <span class="hljs-keyword">for</span> (v <span class="hljs-keyword">of</span> <span class="hljs-built_in">arguments</span>) {
    <span class="hljs-built_in">console</span>.log(v);
    <span class="hljs-comment">// &#x27;l&#x27;</span>
    <span class="hljs-comment">// &#x27;o&#x27;</span>
    <span class="hljs-comment">// &#x27;l&#x27;</span>
  }
}
test(<span class="hljs-string">&quot;l&quot;</span>, <span class="hljs-string">&quot;o&quot;</span>, <span class="hljs-string">&quot;l&quot;</span>);

<span class="hljs-comment">// Les NodeList retournés par l&#x27;API DOM également !</span>
<span class="hljs-keyword">const</span> matches = <span class="hljs-built_in">document</span>.querySelectorAll(<span class="hljs-string">&quot;div&quot;</span>);
<span class="hljs-keyword">for</span> (m <span class="hljs-keyword">of</span> matches) {
  <span class="hljs-built_in">console</span>.log(m);
  <span class="hljs-comment">// &lt;div id=&quot;topSection&quot;&gt;</span>
  <span class="hljs-comment">// &lt;div id=&quot;brandLogo&quot;&gt;</span>
  <span class="hljs-comment">// ...</span>
}
</code></pre>
<p>Autre point : Array, TypedArray, Map, Set sont des Iterable mais définissent
aussi des méthodes qui retournent également des Iterable (ça va, vous suivez
toujours ?) :</p>
<ul>
<li>entries() retourne un ensemble des clés/valeurs</li>
<li>keys() retourne les clés</li>
<li>values() retourne les valeurs</li>
</ul>
<pre><code class="language-js"><span class="hljs-keyword">for</span> (cleVals <span class="hljs-keyword">of</span> arr.entries()) {
  <span class="hljs-built_in">console</span>.log(cleVals);
  <span class="hljs-comment">// [0, &quot;l&quot;]</span>
  <span class="hljs-comment">// [1, &quot;o&quot;]</span>
  <span class="hljs-comment">// [2, &quot;l&quot;]</span>
}
</code></pre>
<p>Détail important, <code>Object</code> n'est pas Iterable mais il n'est pas impossible de
voir apparaitre dans l'ES7 les méthodes entries(), keys() et values() sur Object
(cf.
<a href="https://github.com/tc39/proposal-object-values-entries">la proposition spec</a>).</p>
<h1>Conclusion</h1>
<p>J’espère que cet article a bien illustré l’importance de ce protocole dans le
langage. Nous avons vu ci-dessus que de nombreux concepts du langage tirent déjà
avantage de ce protocole mais il est au moins aussi important de noter que cela
permet d’établir une convention sur laquelle des librairies externes peuvent
s’appuyer.</p>
<p>Elles peuvent le faire de 2 manières :</p>
<ul>
<li>en proposant des sources de données qui implémentent le protocole (ex: liste
chaînée)</li>
<li>en tant que consommateur du protocole (ex: un algorithme de tri)</li>
</ul>
<h1>Un dernier verre pour la route</h1>
<p>Les articles suivants vous permettront d'aller encore plus loin dans le sujet.
Vous y apprendrez notamment qu’un iterator peut retourner en option 2 autres
méthodes, qu’un générateur est à la fois un Iterable et un Iterator, qu’un
Iterable peut être infini ou encore des exemples d’implémentations divers et
variés :</p>
<ul>
<li><a href="http://www.2ality.com/2015/02/es6-iteration.html">Iterables and iterators in ECMAScript 6</a></li>
<li><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Iteration_protocols">Iteration Protocols</a></li>
<li><a href="https://hacks.mozilla.org/2015/04/es6-in-depth-iterators-and-the-for-of-loop/">ES6 in depth : iterators and the for of loop</a></li>
<li><a href="https://ponyfoo.com/articles/es6-iterators-in-depth">ES6 iterators in depth</a></li>
</ul>
<p>La pratique restant le meilleur moyen de se former, le site
<a href="http://es6katas.org/">ES6 Katas</a> est très bien fait pour s'exercer.</p>
</div><style data-emotion-rpcss="v01ydp">.rpcss-v01ydp{max-width:640px;width:100%;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:row;-ms-flex-direction:row;flex-direction:row;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:justify;-webkit-justify-content:space-between;-ms-flex-pack:justify;justify-content:space-between;margin:20px auto;padding:20px;background-color:#fff;border-radius:10px;box-shadow:0 15px 15px -5px rgba(0,0,0,0.2);}@media (prefers-color-scheme:dark){.rpcss-v01ydp{background-color:#222;}}@media (max-width:540px){.rpcss-v01ydp{-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;}}</style><div class="rpcss-v01ydp"><style data-emotion-rpcss="ty7r4z">.rpcss-ty7r4z{font-weight:800;}</style><div class="rpcss-ty7r4z">Vous avez aimé cet article?</div><style data-emotion-rpcss="bb4ce3">.rpcss-bb4ce3{width:0px;height:10px;-webkit-flex-shrink:0;-ms-flex-negative:0;flex-shrink:0;}</style><div class="rpcss-bb4ce3"></div><style data-emotion-rpcss="1pkr03v">.rpcss-1pkr03v{background-color:#00aced;color:#fff;padding:10px 20px;-webkit-text-decoration:none;text-decoration:none;border-radius:5px;font-weight:800;}.rpcss-1pkr03v:active{opacity:0.5;}</style><a class="rpcss-1pkr03v" href="https://www.twitter.com/intent/tweet?text=ES6%2C%20ES2015%20%3A%20le%20protocole%20d&#x27;it%C3%A9ration%20sur%20%40PutainDeCode%20https%3A%2F%2Fputaindecode.io%2Farticles%2Fes6-es2015-le-protocole-d-iteration" target="_blank">Le partager sur Twitter</a></div><style data-emotion-rpcss="x4iqxe">.rpcss-x4iqxe{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;text-align:center;padding:20px;}</style><div class="rpcss-x4iqxe"><style data-emotion-rpcss="gein6x">.rpcss-gein6x{font-size:20px;-webkit-text-decoration:none;text-decoration:none;color:#1E49B5;}</style><a class="rpcss-gein6x" href="/articles">← Articles</a></div><style data-emotion-rpcss="8bodgl">.rpcss-8bodgl{max-width:640px;width:100%;margin:0 auto;padding:20px 0;}</style><div class="rpcss-8bodgl" id="disqus_thread"></div></div></div></div></div><div class="rpcss-1qqk0tr"><div class="rpcss-qx7dny"><style data-emotion-rpcss="5518eg">.rpcss-5518eg{margin-top:20px;margin-bottom:20px;background-color:#E4EBEE;border-radius:10px;padding:20px;}@media (prefers-color-scheme:dark){.rpcss-5518eg{background-color:#111;}}</style><div class="rpcss-5518eg"><style data-emotion-rpcss="1gz1i1h">.rpcss-1gz1i1h{font-size:32px;font-weight:800;margin-bottom:20px;text-align:center;}</style><div aria-level="2" class="rpcss-1gz1i1h" role="heading">Ne rien rater</div><style data-emotion-rpcss="1wbispj">.rpcss-1wbispj{font-size:18px;margin-bottom:10px;text-align:center;}</style><div aria-level="3" class="rpcss-1wbispj" role="heading">Sur les réseaux</div><style data-emotion-rpcss="1hyoz7m">.rpcss-1hyoz7m{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:row;-ms-flex-direction:row;flex-direction:row;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;}</style><div class="rpcss-1hyoz7m"><a href="https://twitter.com/PutainDeCode"><img alt="Twitter" height="48" src="/public/images/website/twitter.svg" width="48"/></a><div class="rpcss-4cf197"></div><a href="https://facebook.com/putaindecode"><img alt="Facebook" height="48" src="/public/images/website/facebook.svg" width="48"/></a><div class="rpcss-4cf197"></div><a href="https://github.com/putaindecode"><img alt="Facebook" height="48" src="/public/images/website/github.svg" width="48"/></a><div class="rpcss-4cf197"></div><a href="https://itunes.apple.com/fr/podcast/putain-de-code-!/id1185311825"><img alt="Apple Podcast" height="48" src="/public/images/website/apple-podcast.svg" width="48"/></a><div class="rpcss-4cf197"></div><a href="https://soundcloud.com/putaindecode"><img alt="Soundcloud" height="48" src="/public/images/website/soundcloud.svg" width="48"/></a></div><div aria-level="3" class="rpcss-1wbispj" role="heading">Sur le chat</div><div class="rpcss-1hyoz7m"><a href="https://discord.gg/jtbGNNc"><img alt="Discord" height="48" src="/public/images/website/discord.svg" width="48"/></a></div></div></div></div><style data-emotion-rpcss="zs8kw7">.rpcss-zs8kw7{background-color:#222;padding:20px 0;}</style><footer class="rpcss-zs8kw7"><div class="rpcss-1qqk0tr"><div class="rpcss-qx7dny"><style data-emotion-rpcss="79elbk">.rpcss-79elbk{position:relative;}</style><div class="rpcss-79elbk"><style data-emotion-rpcss="1hle0ni">.rpcss-1hle0ni{position:absolute;left:0;top:50%;color:#fff;-webkit-transform:translateY(-50%);-ms-transform:translateY(-50%);transform:translateY(-50%);-webkit-text-decoration:none;text-decoration:none;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:row;-ms-flex-direction:row;flex-direction:row;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;}</style><a class="rpcss-1hle0ni" href="/api/articles/feeds/desc/feed.xml"><style data-emotion-rpcss="lvyu5j">.rpcss-lvyu5j{margin-right:10px;}</style><img class="rpcss-lvyu5j" alt="Flux RSS" height="16" src="/public/images/website/rss-feed.svg" width="16"/><style data-emotion-rpcss="um3i31">@media (max-width:400px){.rpcss-um3i31{display:none;}}</style><div class="rpcss-um3i31">Flux RSS</div></a><style data-emotion-rpcss="12cp4l7">.rpcss-12cp4l7{color:rgba(255,255,255,0.5);text-align:center;font-size:14px;}</style><div class="rpcss-12cp4l7">© 2020 Putain de code !</div><style data-emotion-rpcss="1y2rkzl">.rpcss-1y2rkzl{position:absolute;right:0;top:50%;-webkit-transform:translateY(-50%);-ms-transform:translateY(-50%);transform:translateY(-50%);color:#fff;-webkit-text-decoration:none;text-decoration:none;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:row;-ms-flex-direction:row;flex-direction:row;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;}</style><a class="rpcss-1y2rkzl" href="https://github.com/putaindecode/putaindecode.io">GitHub</a></div></div></div></footer></div><script id="initialData" type="text/data">{"lists":{"RE_PRIVATE_NONE":true},"items":{"k":"articles","v":{"k":"es6-es2015-le-protocole-d-iteration","v":{"_0":{"TAG":0,"_0":{"slug":"es6-es2015-le-protocole-d-iteration","filename":"2015-12-09-es6-es2015-le-protocole-d-iteration","title":"ES6, ES2015 : le protocole d'itération","date":"Wed, 09 Dec 2015 00:00:00 GMT","draft":false,"meta":{"date":"2015-12-09T00:00:00.000Z","title":"ES6, ES2015 : le protocole d'itération","author":"ffesseler","oldSlug":"js/es2015/iterators","slug":"es6-es2015-le-protocole-d-iteration"},"body":"<p>Imaginez un concept si important que si vous l’enleviez du langage, il faudrait\nen conséquence enlever le spread, le destructuring, les générateurs, le for…of\net bien d’autres. Ce concept, introduit dans l’ES6, est en fait un protocole :\nle protocole d’itération.</p>\n<p>Le principe est de définir une convention dans le langage, qui permet de\nstandardiser la façon dont des sources de données peuvent être traversées.</p>\n<p>Première bonne nouvelle, ce protocole est assez simple à comprendre et se base\nsur 2 &quot;interfaces&quot; (oui les guillemets c’est pour dire qu’on ne parle pas\nd’interface au sens technique, puisqu’elles n’existent pas en JS).</p>\n<p>La première interface, appelée <strong>Iterator</strong> permet à un objet de produire des\nvaleurs en séquence. Un objet est un Iterator lorsqu’il implémente une function\n<code>next()</code> qui retourne un objet avec 2 propriétés :</p>\n<ul>\n<li><code>value</code>: la valeur courante lors de l'itération</li>\n<li><code>done</code> : un booléen qui indique si on a atteint la fin de l’itération ou non</li>\n</ul>\n<p>Les appels successifs à la méthode <code>next()</code> d’un Iterator permettent donc de\ntraverser et récupérer les valeurs d’un objet. Prenons l’exemple de l’Iterator\nretourné par un Array qui contiendrait 2 valeurs (&quot;a&quot; et &quot;b&quot;) :</p>\n<pre><code class=\"language-js\">iteratorArray.next();\n<span class=\"hljs-comment\">// -&gt; Object {value: &quot;a&quot;, done: false}</span>\niteratorArray.next();\n<span class=\"hljs-comment\">// -&gt; Object {value: &quot;b&quot;, done: false}</span>\niteratorArray.next();\n<span class=\"hljs-comment\">// -&gt; Object {value: undefined, done: true}</span>\n</code></pre>\n<p>Mais comment récupérer l’Iterator d’un objet vas-tu me dire ? (n’est-ce pas ?)\nÇa tombe bien, c’est le rôle de la seconde interface, appelée <strong>Iterable</strong>. Un\nobjet est Iterable s’il implémente une méthode particulière qui va retourner\nl'Iterator. Cette méthode particulière (appelée <em>@@iterator</em> dans la\nspécification) doit être définie en utilisant le symbole <code>[Symbol.iterator]</code>.\n(Les symboles seront expliqués dans un prochain article, pas de panique).</p>\n<p>En reprenant l’exemple précédent, voici comment récupérer l’Iterator d’un Array\n:</p>\n<pre><code class=\"language-js\"><span class=\"hljs-keyword\">const</span> arr = [<span class=\"hljs-string\">&quot;a&quot;</span>, <span class=\"hljs-string\">&quot;b&quot;</span>];\n<span class=\"hljs-keyword\">const</span> iteratorArray = arr[<span class=\"hljs-built_in\">Symbol</span>.iterator]();\niteratorArray.next();\n<span class=\"hljs-comment\">// -&gt; Object {value: &quot;a&quot;, done: false}</span>\niteratorArray.next();\n<span class=\"hljs-comment\">// -&gt; Object {value: &quot;b&quot;, done: false}</span>\niteratorArray.next();\n<span class=\"hljs-comment\">// -&gt; Object {value: undefined, done: true}</span>\n</code></pre>\n<p>L’exemple ci-dessus illustre donc l’implémentation du protocole par l’Array. Il\nn’est pas très utile en soi, en voici donc un autre qui va permettre de boucler\nsur les valeurs et les afficher :</p>\n<pre><code class=\"language-js\"><span class=\"hljs-keyword\">const</span> arr = [<span class=\"hljs-string\">&quot;a&quot;</span>, <span class=\"hljs-string\">&quot;b&quot;</span>];\n<span class=\"hljs-keyword\">var</span> iterator = arr[<span class=\"hljs-built_in\">Symbol</span>.iterator]();\n\n<span class=\"hljs-keyword\">var</span> result = iterator.next();\n<span class=\"hljs-keyword\">while</span> (!result.done) {\n  <span class=\"hljs-built_in\">console</span>.log(result.value);\n  result = iterator.next();\n}\n<span class=\"hljs-comment\">// &#x27;a&#x27;</span>\n<span class=\"hljs-comment\">// &#x27;b&#x27;</span>\n</code></pre>\n<p>De manière générale, quand un objet qui implémente le protocole d’itération est\ntraversé, sa méthode <em>@@iterator</em> est appelée (une seule fois donc) et\nl’Iterator retourné est utilisé pour boucler sur ses valeurs.</p>\n<h1>Consommateurs d'Iterable</h1>\n<p>La deuxième bonne nouvelle, c’est que plusieurs concepts du langage tirent\navantage de ce protocole :</p>\n<ul>\n<li>Certaines syntaxes s’attendent à recevoir des Iterables</li>\n</ul>\n<pre><code class=\"language-js\"><span class=\"hljs-keyword\">const</span> arr = [<span class=\"hljs-string\">&quot;a&quot;</span>, <span class=\"hljs-string\">&quot;b&quot;</span>];\n\n<span class=\"hljs-comment\">// La syntaxe à laquelle on pense immédiatement est la syntaxe « for .. of »</span>\n<span class=\"hljs-comment\">// qui permet de boucler sur les valeurs des Iterables.</span>\n<span class=\"hljs-keyword\">for</span> (val <span class=\"hljs-keyword\">of</span> arr) {\n  <span class=\"hljs-built_in\">console</span>.log(val);\n}\n\n<span class=\"hljs-comment\">// Le spread qui permet d&#x27;insérer facilement des valeurs dans un Array</span>\n<span class=\"hljs-comment\">// utilise également des Iterable</span>\n[<span class=\"hljs-string\">&quot;0&quot;</span>, ...arr, <span class=\"hljs-string\">&quot;1&quot;</span>]; <span class=\"hljs-comment\">// 0, a, b, 1</span>\n\n<span class=\"hljs-comment\">// yield nécessite également des Iterable</span>\n<span class=\"hljs-function\"><span class=\"hljs-keyword\">function</span>* <span class=\"hljs-title\">gen</span>(<span class=\"hljs-params\"></span>) </span>{\n  <span class=\"hljs-keyword\">yield</span>* arr;\n}\ngen().next(); <span class=\"hljs-comment\">// { value:&quot;a&quot;, done:false }</span>\n\n<span class=\"hljs-comment\">// Le destructuring avec le pattern Array</span>\n<span class=\"hljs-keyword\">const</span> [x, y] = arr; <span class=\"hljs-comment\">// x = &#x27;a&#x27;,  y = &quot;b&quot;</span>\n</code></pre>\n<ul>\n<li>Des API acceptent également des Iterables</li>\n</ul>\n<pre><code class=\"language-js\"><span class=\"hljs-keyword\">const</span> arr = [<span class=\"hljs-string\">&quot;a&quot;</span>, <span class=\"hljs-string\">&quot;b&quot;</span>, <span class=\"hljs-string\">&quot;b&quot;</span>];\n\n<span class=\"hljs-comment\">// Certains constructeurs acceptent des Iterable</span>\n\n<span class=\"hljs-comment\">// Set et Weakset</span>\n<span class=\"hljs-keyword\">const</span> set = <span class=\"hljs-keyword\">new</span> <span class=\"hljs-built_in\">Set</span>(arr);\nset.has(<span class=\"hljs-string\">&quot;b&quot;</span>); <span class=\"hljs-comment\">// true</span>\n<span class=\"hljs-comment\">// Map et WeakMap</span>\n<span class=\"hljs-keyword\">const</span> map = <span class=\"hljs-keyword\">new</span> <span class=\"hljs-built_in\">Map</span>(arr.entries()); <span class=\"hljs-comment\">// Attention, le constructeur attend un ensemble [clé, valeur]</span>\nmap.get(<span class=\"hljs-number\">0</span>); <span class=\"hljs-comment\">// &#x27;a&#x27;</span>\n\n<span class=\"hljs-comment\">// Ou encore les API suivants :</span>\n\n<span class=\"hljs-built_in\">Array</span>.from(iterable); <span class=\"hljs-comment\">// transforme n&#x27;importe quel Iterable en Array.</span>\n<span class=\"hljs-built_in\">Promise</span>.all(iterableCollectionDePromises); <span class=\"hljs-comment\">// n&#x27;importe quel Iterable qui contient un ensemble de Promises</span>\n<span class=\"hljs-built_in\">Promise</span>.race(iterableCollectionDePromises); <span class=\"hljs-comment\">// idem</span>\n</code></pre>\n<h1>Built-in Iterable</h1>\n<p>Troisième bonne nouvelle, plusieurs objets du langage implémentent déjà ce\nprotocole :</p>\n<pre><code class=\"language-js\"><span class=\"hljs-comment\">// évidemment les Array</span>\n<span class=\"hljs-keyword\">const</span> arr = [<span class=\"hljs-string\">&quot;l&quot;</span>, <span class=\"hljs-string\">&quot;o&quot;</span>, <span class=\"hljs-string\">&quot;l&quot;</span>];\n<span class=\"hljs-keyword\">for</span> (v <span class=\"hljs-keyword\">of</span> arr) {\n  <span class=\"hljs-built_in\">console</span>.log(v);\n  <span class=\"hljs-comment\">// &#x27;l&#x27;</span>\n  <span class=\"hljs-comment\">// &#x27;o&#x27;</span>\n  <span class=\"hljs-comment\">// &#x27;l&#x27;</span>\n}\n\n<span class=\"hljs-comment\">// les String</span>\n<span class=\"hljs-keyword\">const</span> str = <span class=\"hljs-string\">&quot;lol&quot;</span>;\n<span class=\"hljs-keyword\">for</span> (v <span class=\"hljs-keyword\">of</span> str) {\n  <span class=\"hljs-built_in\">console</span>.log(v);\n  <span class=\"hljs-comment\">// &#x27;l&#x27;</span>\n  <span class=\"hljs-comment\">// &#x27;o&#x27;</span>\n  <span class=\"hljs-comment\">// &#x27;l&#x27;</span>\n}\n\n<span class=\"hljs-comment\">// les Map et Set (mais PAS WeakMap et WeakSet)</span>\n<span class=\"hljs-keyword\">const</span> map = <span class=\"hljs-keyword\">new</span> <span class=\"hljs-built_in\">Map</span>().set(<span class=\"hljs-string\">&quot;l&quot;</span>, <span class=\"hljs-number\">1</span>).set(<span class=\"hljs-string\">&quot;o&quot;</span>, <span class=\"hljs-number\">2</span>);\n<span class=\"hljs-keyword\">for</span> (v <span class=\"hljs-keyword\">of</span> map) {\n  <span class=\"hljs-built_in\">console</span>.log(v);\n  <span class=\"hljs-comment\">// [&quot;l&quot;, 1]</span>\n  <span class=\"hljs-comment\">// [&quot;o&quot;, 2]</span>\n}\n<span class=\"hljs-keyword\">const</span> set = <span class=\"hljs-keyword\">new</span> <span class=\"hljs-built_in\">Set</span>().add(<span class=\"hljs-string\">&quot;l&quot;</span>).add(<span class=\"hljs-string\">&quot;o&quot;</span>);\n<span class=\"hljs-keyword\">for</span> (v <span class=\"hljs-keyword\">of</span> map) {\n  <span class=\"hljs-built_in\">console</span>.log(v);\n  <span class=\"hljs-comment\">// &#x27;l&#x27;</span>\n  <span class=\"hljs-comment\">// &#x27;o&#x27;</span>\n}\n\n<span class=\"hljs-comment\">// Les TypedArray que vous utilisez tous les jours</span>\n<span class=\"hljs-keyword\">const</span> int16 = <span class=\"hljs-keyword\">new</span> <span class=\"hljs-built_in\">Int16Array</span>(<span class=\"hljs-number\">2</span>);\nint16[<span class=\"hljs-number\">0</span>] = <span class=\"hljs-number\">42</span>;\n<span class=\"hljs-keyword\">for</span> (v <span class=\"hljs-keyword\">of</span> int16) {\n  <span class=\"hljs-built_in\">console</span>.log(v);\n  <span class=\"hljs-comment\">// 42</span>\n  <span class=\"hljs-comment\">// 0</span>\n}\n\n<span class=\"hljs-comment\">// Même l&#x27;objet spécial arguments (que vous</span>\n<span class=\"hljs-comment\">// ne devriez plus utiliser avec l&#x27;ES6) est un Iterable</span>\n<span class=\"hljs-function\"><span class=\"hljs-keyword\">function</span> <span class=\"hljs-title\">test</span>(<span class=\"hljs-params\"></span>) </span>{\n  <span class=\"hljs-keyword\">for</span> (v <span class=\"hljs-keyword\">of</span> <span class=\"hljs-built_in\">arguments</span>) {\n    <span class=\"hljs-built_in\">console</span>.log(v);\n    <span class=\"hljs-comment\">// &#x27;l&#x27;</span>\n    <span class=\"hljs-comment\">// &#x27;o&#x27;</span>\n    <span class=\"hljs-comment\">// &#x27;l&#x27;</span>\n  }\n}\ntest(<span class=\"hljs-string\">&quot;l&quot;</span>, <span class=\"hljs-string\">&quot;o&quot;</span>, <span class=\"hljs-string\">&quot;l&quot;</span>);\n\n<span class=\"hljs-comment\">// Les NodeList retournés par l&#x27;API DOM également !</span>\n<span class=\"hljs-keyword\">const</span> matches = <span class=\"hljs-built_in\">document</span>.querySelectorAll(<span class=\"hljs-string\">&quot;div&quot;</span>);\n<span class=\"hljs-keyword\">for</span> (m <span class=\"hljs-keyword\">of</span> matches) {\n  <span class=\"hljs-built_in\">console</span>.log(m);\n  <span class=\"hljs-comment\">// &lt;div id=&quot;topSection&quot;&gt;</span>\n  <span class=\"hljs-comment\">// &lt;div id=&quot;brandLogo&quot;&gt;</span>\n  <span class=\"hljs-comment\">// ...</span>\n}\n</code></pre>\n<p>Autre point : Array, TypedArray, Map, Set sont des Iterable mais définissent\naussi des méthodes qui retournent également des Iterable (ça va, vous suivez\ntoujours ?) :</p>\n<ul>\n<li>entries() retourne un ensemble des clés/valeurs</li>\n<li>keys() retourne les clés</li>\n<li>values() retourne les valeurs</li>\n</ul>\n<pre><code class=\"language-js\"><span class=\"hljs-keyword\">for</span> (cleVals <span class=\"hljs-keyword\">of</span> arr.entries()) {\n  <span class=\"hljs-built_in\">console</span>.log(cleVals);\n  <span class=\"hljs-comment\">// [0, &quot;l&quot;]</span>\n  <span class=\"hljs-comment\">// [1, &quot;o&quot;]</span>\n  <span class=\"hljs-comment\">// [2, &quot;l&quot;]</span>\n}\n</code></pre>\n<p>Détail important, <code>Object</code> n'est pas Iterable mais il n'est pas impossible de\nvoir apparaitre dans l'ES7 les méthodes entries(), keys() et values() sur Object\n(cf.\n<a href=\"https://github.com/tc39/proposal-object-values-entries\">la proposition spec</a>).</p>\n<h1>Conclusion</h1>\n<p>J’espère que cet article a bien illustré l’importance de ce protocole dans le\nlangage. Nous avons vu ci-dessus que de nombreux concepts du langage tirent déjà\navantage de ce protocole mais il est au moins aussi important de noter que cela\npermet d’établir une convention sur laquelle des librairies externes peuvent\ns’appuyer.</p>\n<p>Elles peuvent le faire de 2 manières :</p>\n<ul>\n<li>en proposant des sources de données qui implémentent le protocole (ex: liste\nchaînée)</li>\n<li>en tant que consommateur du protocole (ex: un algorithme de tri)</li>\n</ul>\n<h1>Un dernier verre pour la route</h1>\n<p>Les articles suivants vous permettront d'aller encore plus loin dans le sujet.\nVous y apprendrez notamment qu’un iterator peut retourner en option 2 autres\nméthodes, qu’un générateur est à la fois un Iterable et un Iterator, qu’un\nIterable peut être infini ou encore des exemples d’implémentations divers et\nvariés :</p>\n<ul>\n<li><a href=\"http://www.2ality.com/2015/02/es6-iteration.html\">Iterables and iterators in ECMAScript 6</a></li>\n<li><a href=\"https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Iteration_protocols\">Iteration Protocols</a></li>\n<li><a href=\"https://hacks.mozilla.org/2015/04/es6-in-depth-iterators-and-the-for-of-loop/\">ES6 in depth : iterators and the for of loop</a></li>\n<li><a href=\"https://ponyfoo.com/articles/es6-iterators-in-depth\">ES6 iterators in depth</a></li>\n</ul>\n<p>La pratique restant le meilleur moyen de se former, le site\n<a href=\"http://es6katas.org/\">ES6 Katas</a> est très bien fait pour s'exercer.</p>\n"}}},"h":1,"l":{"RE_PRIVATE_NONE":true},"r":{"RE_PRIVATE_NONE":true}},"h":1,"l":{"RE_PRIVATE_NONE":true},"r":{"RE_PRIVATE_NONE":true}},"listsRequests":{"data":{"RE_PRIVATE_NONE":true}},"itemsRequests":{"data":{"RE_PRIVATE_NONE":true}}}</script><head><script defer="defer" src="/public/main.43c11cd353d1f8865185.js"></script></head></html>